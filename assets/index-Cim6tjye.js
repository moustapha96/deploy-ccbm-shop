var k=Object.defineProperty,q=Object.defineProperties;var F=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var w=(t,s,l)=>s in t?k(t,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[s]=l,x=(t,s)=>{for(var l in s||(s={}))S.call(s,l)&&w(t,l,s[l]);if(v)for(var l of v(s))A.call(s,l)&&w(t,l,s[l]);return t},m=(t,s)=>q(t,F(s));var C=(t,s,l)=>new Promise((h,a)=>{var r=n=>{try{p(l.next(n))}catch(u){a(u)}},o=n=>{try{p(l.throw(n))}catch(u){a(u)}},p=n=>n.done?h(n.value):Promise.resolve(n.value).then(r,o);p((l=l.apply(t,s)).next())});import{P as T,u as M,j as e,R as E,o as L,h as I,i as R,l as $,m as B,p as P,L as O,q as z}from"./index-B2FoVRhR.js";import{b as g,c as D,u as H}from"./vendor-KAqkdx26.js";function U({className:t,filterToggle:s,updateUrlParams:l,type:h=3}){const{filters:a,updateFilters:r}=g.useContext(T),{user:o}=M(),p=i=>{r(m(x({},a),{min:i[0],max:i[1],page:1})),l(m(x({},a),{min:i[0],max:i[1],page:1}))},n=i=>{const d=i.target.value;r(m(x({},a),{productType:d,page:1})),l(m(x({},a),{productType:d,page:1}))},u=i=>{const d=i.target.value;r(m(x({},a),{tag:d,page:1})),l(m(x({},a),{tag:d,page:1}))},[j,y]=g.useState([]);return g.useEffect(()=>{C(null,null,function*(){try{const d=yield L.getTags();y(d),console.log(d)}catch(d){console.error("Erreur lors de la récupération des catégories",d)}})},[]),e.jsxs("div",{className:`filter-widget w-full fixed lg:relative left-0 top-0 h-screen z-10 lg:h-auto overflow-y-scroll lg:overflow-y-auto bg-white px-[30px] pt-[40px] ${t||""} ${s?"block":"hidden lg:block"}`,children:[e.jsxs("div",{className:"filter-subject-item pb-10 border-b border-qgray-border",children:[e.jsx("div",{className:"subject-title mb-[20px]",children:e.jsx("h1",{className:"text-black text-base font-500",children:"Type de produits"})}),e.jsxs("div",{className:"flex flex-col gap-3 text-sm text-qgray",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",value:"All",name:"productType",checked:a.productType==="All",onChange:n}),"Tous les produits"]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",value:"promo",name:"productType",checked:a.productType==="promo",onChange:n}),"Produits en promo"]}),o&&e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",value:"credit",name:"productType",checked:a.productType==="credit",onChange:n}),"Produits à crédit"]})]})]}),e.jsxs("div",{className:"filter-subject-item pb-10 border-b border-qgray-border mt-10",children:[e.jsx("div",{className:"subject-title mb-[20px]",children:e.jsx("h1",{className:"text-black text-base font-500",children:"Filtrer par tags"})}),e.jsx("div",{className:"text-sm text-qgray",children:e.jsxs("select",{className:"w-full border border-qgray-border px-3 py-2 rounded",value:a.tag||"",onChange:u,children:[e.jsx("option",{value:"",children:"Tous les tags"}),j.map(i=>e.jsx("option",{value:i.slug||i.name,children:i.name},i.id))]})})]}),e.jsxs("div",{className:"filter-subject-item pb-10 border-b border-qgray-border mt-10",children:[e.jsx("div",{className:"subject-title mb-[30px]",children:e.jsx("h1",{className:"text-black text-base font-500",children:"Échelle des prix"})}),e.jsx("div",{className:"price-range mb-5",children:e.jsx(E,{value:[a.min,a.max],onInput:p,min:4e3,max:5e6})}),e.jsxs("p",{className:"text-xs text-qblack font-400",children:["Prix (FCFA): ",a.min," - ",a.max]})]})]})}const V=({currentPage:t,totalPages:s,onPageChange:l})=>{const h=()=>{const r=[];for(let o=Math.max(2,t-2);o<=Math.min(s-1,t+2);o++)r.push(o);return t-2>2&&r.unshift("..."),t+2<s-1&&r.push("..."),r.unshift(1),s!==1&&r.push(s),r};return e.jsx("nav",{className:"flex justify-center items-center mt-8 px-4","aria-label":"Pagination",children:e.jsxs("ul",{className:"flex flex-wrap justify-center items-center space-x-1 md:space-x-2",children:[e.jsx("li",{children:e.jsx("button",{onClick:()=>l(Math.max(1,t-1)),disabled:t===1,className:"p-2 rounded-full bg-gray-200 text-gray-700 hover:bg-qyellow disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Previous page",children:e.jsx(I,{className:"w-5 h-5"})})}),h().map((a,r)=>e.jsx("li",{children:typeof a=="number"?e.jsx("button",{onClick:()=>l(a),className:`hidden sm:block px-3 py-2 rounded ${t===a?"bg-bleu-logo text-white":"bg-gray-200 text-gray-700 hover:bg-qyellow"}`,"aria-current":t===a?"page":void 0,children:a}):e.jsx("span",{className:"hidden sm:block px-3 py-2",children:a})},r)),e.jsx("li",{className:"sm:hidden",children:e.jsxs("span",{className:"px-3 py-2 text-gray-700",children:[t," / ",s]})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>l(Math.min(s,t+1)),disabled:t===s,className:"p-2 rounded-full bg-gray-200 text-gray-700 hover:bg-qyellow disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Next page",children:e.jsx(R,{className:"w-5 h-5"})})})]})})};function Q(){const{currentProducts:t,totalProducts:s,isLoadingProduct:l,fetchProducts:h,updateFilters:a,resetFilters:r,filters:o}=g.useContext(T),p=D(),n=H();g.useEffect(()=>{r();const c=new URLSearchParams(p.search),b={page:Number.parseInt(c.get("page"))||1,category:c.get("category")||"All",search:c.get("search")||"",min:Number.parseInt(c.get("min"))||1e3,max:Number.parseInt(c.get("max"))||5e6,limit:9,productType:c.get("productType")||"All",tag:c.get("tag")||"All"};a(b),window.scrollTo({top:0,left:100,behavior:"smooth"})},[p.pathname,p.search,r,a]),g.useEffect(()=>{h()},[h]);const u=(o.page-1)*o.limit+1,j=Math.min(o.page*o.limit,s),y=c=>{d(m(x({},o),{page:c})),window.scrollTo({top:0,left:100,behavior:"smooth"})},i=c=>{d({category:c||"All",page:1}),window.scrollTo({top:0,left:100,behavior:"smooth"})},d=g.useCallback(c=>{const b=new URLSearchParams(p.search);Object.entries(c).forEach(([N,f])=>{f!=null&&f!==""?b.set(N,f.toString()):b.delete(N)}),n({search:b.toString()},{replace:!0})},[p.search,n]);return e.jsxs(e.Fragment,{children:[e.jsx($,{title:"CCBM Shop | Boutique",description:"Découvrez les meilleures offres sur CCBM Shop, votre destination privilégiée pour l'électroménager de qualité.",keywords:"électroménager, boutique en ligne d'électroménager, CCBM Shop, ccbme, appareils électroménagers à prix réduits"}),e.jsx(B,{children:e.jsx("div",{className:"products-page-wrapper w-full",children:e.jsxs("div",{className:"container-x mx-auto",children:[e.jsx(P,{}),e.jsxs("div",{className:"w-full lg:flex lg:space-x-[30px]",children:[e.jsx("div",{className:"lg:w-[270px]",children:e.jsx(U,{handleCategoryChange:i,updateUrlParams:d})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"products-sorting w-full bg-white flex flex-col md:flex-row justify-between p-[30px] mb-[40px]",children:e.jsxs("p",{className:"font-400 text-[13px]",children:[e.jsx("span",{className:"text-qgray",children:"Affichage"})," ",s>0?`${u}–${j} sur ${s} résultats`:"0 résultat"]})}),l?e.jsxs("div",{className:"flex justify-center items-center",children:[e.jsx(O,{className:"animate-spin"})," Chargement"]}):t.length===0?e.jsx("div",{className:"flex justify-center items-center",children:"Pas de produits disponible pour le moment"}):e.jsx("div",{className:"grid xl:grid-cols-3 grid-cols-2 gap-[30px]",children:t.map(c=>e.jsx(z,{datas:c},c.id))}),e.jsx(V,{currentPage:o.page,totalPages:Math.ceil(s/o.limit),onPageChange:y})]})]})]})})})]})}export{Q as default};
