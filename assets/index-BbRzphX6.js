var g=(x,d,i)=>new Promise((u,r)=>{var n=s=>{try{o(i.next(s))}catch(p){r(p)}},h=s=>{try{o(i.throw(s))}catch(p){r(p)}},o=s=>s.done?u(s.value):Promise.resolve(s.value).then(n,h);o((i=i.apply(x,d)).next())});import{C as _,u as q,j as e,l as k,m as S,p as B,A as E,f as D,t as L,n as M,O as A,B as c,I as b}from"./index-B2FoVRhR.js";import{b as m,u as F,L as T}from"./vendor-KAqkdx26.js";import{P as z}from"./ProductsTable-DazHA-uC.js";import{B as V}from"./BannerPub-BE7uvDK2.js";import"./truck-pBM5RKJq.js";function G({cartt:x=!0}){const{cart:d,getCartTotal:i,clearCart:u}=m.useContext(_),{user:r}=q();console.log("user",r);const[n,h]=m.useState(""),[o,s]=m.useState(!1),[p,I]=m.useState(!1),[v,f]=m.useState(!1),[N,y]=m.useState(null),C=F(),j=l=>{console.log(l.target.value),s(!1),h(l.target.value)},w=l=>g(null,null,function*(){if(l.preventDefault(),n==""){c.dismiss(),c.error("Veuillez choisir un mode de paiement",{position:"top-center",autoClose:5e3}),s(!1);return}if(r){s(!0);const t={partner_id:r.id,type_sale:"order",payment_mode:n!=""?n:"domicile",state:"sale",commitment_date:new Date,order_lines:d.map(a=>({id:a.id,quantity:a.quantity,list_price:a.en_promo?a.promo_price:a.list_price}))};console.log(t);try{const a=yield b.createCommande(t);console.log(a),c.success("Commande créé avec succés",{position:"top-center",autoClose:5e3}),s(!1),C(`/commandes/${a.id}/détails`),console.log(a),u()}catch(a){s(!1),c.error("Commande non validé ",{position:"top-center",autoClose:5e3}),console.error("Erreur lors de la récupération des modèles",a)}}if(!r){const t={partner_id:null,type_sale:"order",payment_mode:n!=""?n:"online",state:"sale",commitment_date:new Date,order_lines:d.map(a=>({id:a.id,quantity:a.quantity,list_price:a.en_promo?a.promo_price:a.list_price}))};console.log(t),y(t),s(!0),f(!0)}}),P=l=>g(null,null,function*(){console.log("Payment data: ",l),f(!1),s(!0);try{const t=yield b.createCommandeWitoutPartner(l);console.log(t),c.success("Commande créé avec succés",{position:"top-center",autoClose:5e3}),C("/boutique"),console.log(t),u(),s(!1)}catch(t){c.error("Commande non validé ",{position:"top-center",autoClose:5e3}),console.error("Erreur lors de la récupération des modèles",t),s(!1)}});return e.jsxs(e.Fragment,{children:[e.jsx(k,{title:"CCBM Shop | Panier Commande",description:"Découvrez les meilleures offres sur CCBM Shop, votre destination privilégiée pour l'électroménager de qualité. Explorez nos produits allant des réfrigérateurs aux téléviseurs intelligents, et profitez de promotions exclusives !",keywords:"électroménager, boutique en ligne d'électroménager, CCBM Shop, ccbme, appareils électroménagers à prix réduits, smart TV, réfrigérateurs modernes, climatiseurs efficaces, promotions électroménager"}),e.jsxs(S,{childrenClasses:x?"pt-0 pb-0":"",children:[x===!1?e.jsx("div",{className:"cart-page-wrapper w-full",children:e.jsx("div",{className:"container-x mx-auto",children:e.jsx(B,{paths:[{name:"Accueil",path:"/"},{name:"Panier Commandes",path:"/cart"}]})})}):e.jsxs("div",{className:"cart-page-wrapper w-full bg-white pb-[60px]",children:[e.jsx("div",{className:"w-full",children:e.jsx(E,{title:"Panier Commande",breadcrumb:[{name:"Accueil",path:"/"},{name:"Panier Commande",path:"/cart"}]})}),e.jsx("div",{className:"w-full mt-[23px]",children:e.jsxs("div",{className:"container-x mx-auto",children:[e.jsx(z,{className:"mb-[30px]"}),e.jsx("div",{className:"w-full sm:flex justify-between",children:e.jsx("div",{className:"flex space-x-2.5 items-center",children:e.jsx(T,{to:"/boutique",children:e.jsx("div",{className:"w-[220px] h-[50px] bg-[#F6F6F6] flex justify-center items-center",children:e.jsx("span",{className:"text-sm font-semibold",children:"Continuer vos achats"})})})})}),e.jsx("div",{className:"w-full mt-[30px] flex sm:justify-end",children:e.jsxs("div",{className:"sm:w-[370px] w-full border border-[#EDEDED] px-[30px] py-[26px]",children:[e.jsx("span",{className:"text-[15px] font-medium text-qblack mb-[18px]  items-center block",children:n==""&&p&&e.jsx("span",{className:"text-red-500",children:" Choisir le mode de paiement "})}),e.jsxs("div",{className:"shipping mb-6",children:[e.jsx("span",{className:"text-[15px] font-medium text-qblack mb-[18px] block",children:"Paiement"}),e.jsxs("ul",{className:"flex flex-col space-y-1",children:[e.jsx("li",{children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex space-x-2.5 items-center",children:[e.jsx("div",{className:"input-radio",children:e.jsx("input",{type:"radio",name:"price",value:"domicile",className:"bg-bleu-logo",onChange:j})}),e.jsx("span",{className:"text-[14px] text-normal text-qblack",children:"A domicile"})]})})}),e.jsx("li",{children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex space-x-2.5 items-center",children:[e.jsx("div",{className:"input-radio",children:e.jsx("input",{type:"radio",name:"price",value:"online",className:"bg-bleu-logo",onChange:j})}),e.jsx("span",{className:"text-[14px] text-normal text-qblack ",children:"En ligne"})]})})}),e.jsx("li",{children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex space-x-2.5 items-center",children:[e.jsx("div",{className:"input-radio",children:e.jsx("input",{type:"radio",name:"price",value:"echelonne",className:"bg-bleu-logo",onChange:j})}),e.jsx("span",{className:"text-[14px] text-normal text-qblack ",children:"Échelonné"})]})})})]})]}),e.jsx("div",{className:"total mb-6",children:e.jsxs("div",{className:" flex justify-between",children:[e.jsx("p",{className:"text-[18px] font-medium text-qblack",children:"Total"}),e.jsxs("p",{className:"text-[18px] font-medium text-qred",children:[" ",D(i())]})]})}),i()!=0&&e.jsxs(L,{type:"submit",className:"hover:bg-red-500  w-full bg-bleu-logo ",onClick:l=>w(l),disabled:o,children:[o&&e.jsx(M,{className:"mr-2 h-4 w-4 animate-spin"}),"Valider le Panier"]})]})})]})}),v&&!r&&e.jsx(e.Fragment,{children:e.jsx(A,{handleCreatePartner:P,order:d,data:N,onClose:()=>{f(!1),s(!1)}})})]}),e.jsx(V,{})]})]})}export{G as default};
